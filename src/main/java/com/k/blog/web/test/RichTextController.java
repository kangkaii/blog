package com.k.blog.web.test;import com.k.blog.model.bo.RestResponseBo;import com.k.blog.utils.DateKit;import org.springframework.stereotype.Controller;import org.springframework.ui.ModelMap;import org.springframework.web.bind.annotation.GetMapping;import org.springframework.web.bind.annotation.PostMapping;import org.springframework.web.bind.annotation.RequestMapping;import org.springframework.web.bind.annotation.RequestParam;import org.springframework.web.bind.annotation.ResponseBody;import org.springframework.web.multipart.MultipartFile;import org.springframework.web.servlet.mvc.support.RedirectAttributes;import org.springframework.web.servlet.mvc.support.RedirectAttributesModelMap;import java.io.IOException;import java.nio.file.Files;import java.nio.file.Path;import java.nio.file.Paths;import java.util.HashMap;import java.util.Map;/** * @author kangkai on 2018/7/11. */@Controller@RequestMapping(value = "/richText")public class RichTextController {    /**     * 跳转页面     */    @GetMapping(value = "/toPage")    public String toRichTextPage() {        return "richText";    }    /**     * 跳转页面     */    @GetMapping(value = "/toUploadPage")    public String toUploadPage() {        return "upload";    }    /**     * 图片上传接口     */    @PostMapping(value = "/uploadImg")    @ResponseBody    public Map<String,String> uploadImg(@RequestParam("upload") MultipartFile file) {        Map<String,String> map = new HashMap<>(16);        if (file.isEmpty()) {            //RestResponseBo.fail("Please select a file to upload");            //redirectAttributes.addFlashAttribute("message", "Please select a file to upload");            //return "redirect:toPage";            map.put("uploaded","0");            map.put("error","maybe The file is too big.");        }        try {            // Get the file and save it somewhere            byte[] bytes = file.getBytes();            Path path = Paths.get(file.getOriginalFilename());            Files.write(path, bytes);            map.put("uploaded","1");            map.put("fileName","img"+file.getOriginalFilename());            map.put("url",path.toString());            //redirectAttributes.addFlashAttribute("message",                   // "You successfully uploaded '" + file.getOriginalFilename() + "'");        } catch (IOException e) {            e.printStackTrace();        }        return map;    }}